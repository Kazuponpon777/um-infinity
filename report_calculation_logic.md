# UM-Infinity System 計算ロジック詳細レポート

## 1. 概要
本レポートは、UM-Infinityシステムの気象・環境モニタリングおよびリスク算出のロジックを詳細に記述したものである。本システムは、Cubical Agdaで形式検証された「情報理論的量子重力理論 (UM-Infinity Theory)」を応用し、気象データを位相幾何学的（トポロジカル）に解析することで、従来の気象予報では捉えきれない「場のポテンシャル（危険度）」を数値化することを目的としている。

## 2. 理論的背景 (Theoretical Framework)
本システムの計算ロジックは、以下の理論的背景に基づいている（`UM_Infinity_V13.agda`参照）。

*   **情報解像度と結合定数**: 宇宙の基本構造を情報の「きめ細かさ」として定義し、その結合定数として $1/137$ を採用。これを重力定数 $G$ の起源とする。
*   **位相幾何学的構造 (Fibration)**: 観測される物理現象を、高次元のバルク（Bulk）から境界（Boundary）への射影としてモデル化。
*   **Winding Number (巻き数)**: 場の「ねじれ」や「渦」を情報の冗長性（Dark Matter）として解釈し、これが重力的・物理的影響力を持つとする。
    *   本システムでは、これを気象データ（流体）に適用し、風の場の「渦度（Curl）」を位相欠陥の指標として計測する。

## 3. 計算アルゴリズム詳細

システムは10分ごとに以下のプロセスを実行し、各グリッド地点 $x$ における「グランド・ポテンシャル (Gup)」を算出する。

### 3.1. 総合評価関数 (Grand Unified Potential Formula)
最終的な危険度指標 $Gup(x)$ は、局所的な流体力学的要因と、広域的な環境要因の積として定義される。

$$ Gup(x) = P_{hydro}(x) \times (1 + C_{cloud}) \times F_{global} $$

各変数の定義は以下の通り：

*   $P_{hydro}(x)$: **Hydro-Topological Potential**（水理-位相ポテンシャル）。その地点の風の渦と湿度の相互作用を表す。
*   $C_{cloud}$: 雲量ファクター（現在の実装ではPoC段階のため $0.0$ 固定）。
*   $F_{global}$: **Global Environmental Factor**（広域環境係数）。宇宙天気、地磁気、都市活動、生体電磁気の影響を統合したもの。

---

### 3.2. Hydro-Topological Potential の算出プロセス
`topology_engine.py` に実装。

#### Step 1: データのグリッド化 (Interpolation)
AMeDAS等の観測地点データを、IDW（逆距離加重法）を用いて正則グリッド（約25km解像度）に補間する。

*   入力: 各地点の $u$ (東西風速), $v$ (南北風速), $T$ (気温), $H$ (湿度)
*   出力: グリッド上のスカラー場およびベクトル場

#### Step 2: 巻き数密度の計算 (Winding Density / Curl)
風のベクトル場 $(\vec{V} = (u, v))$ の離散的な回転（Curl）を計算する。これが理論上の「Winding Number」に相当する。

$$ \text{Curl} = \frac{\Delta v}{\Delta x} - \frac{\Delta u}{\Delta y} $$

#### Step 3: 湿度による非線形増幅
渦（Curl）のエネルギーが相転移（凝結等）によって解放されるポテンシャルを、湿度 $H$ (%) を用いてモデル化する。

$$ P_{hydro} = \text{Curl} \times f(H) $$

ここで湿度関数 $f(H)$ は以下のように定義される：

$$ \text{Base} = \max\left(0, \frac{H - 50}{10}\right) $$

*   **特異点処理**: $H > 90\%$ の場合、係数はさらに **2倍** される。
    *   例: 湿度50%以下 $\to 0$
    *   例: 湿度80% $\to 3.0$
    *   例: 湿度100% $\to 5.0 \times 2.0 = 10.0$

---

### 3.3. Global Environmental Factor の算出プロセス
局所的な気象要因を増幅させる「背景場の歪み」として、以下の4つの要素を乗算する。

$$ F_{global} = (1 + S_{space}) \times (1 + S_{geomag}) \times (1 + S_{urban}) \times (1 + S_{bio}) $$

#### 1. Space Factor (宇宙天気要因)
`fetch_space.py` に実装。
太陽X線フラックス $F_{xray}$ (W/m²) を対数スケールで評価。

$$ S_{space} = \max(0, \log_{10}(F_{xray}) + 8.0) $$

*   物理的意味: 基準値 $10^{-8}$ W/m² (Aクラスフレア相当) を超えるエネルギー流入を係数化。
    *   Xクラス ($10^{-4}$) の場合: $-4 + 8 = 4.0$

#### 2. Geomag Factor (地磁気要因)
`fetch_geomag.py` に実装。
NOAAのKp指数（0-9）を使用。

$$ S_{geomag} = \frac{Kp}{5.0} $$

*   物理的意味: 電離層の擾乱が地表のポテンシャルに与える影響。Kp=5（嵐）で係数1.0となる。

#### 3. Urban Factor (都市活動要因)
`fetch_urban_bio.py` に実装（現在はシミュレーション）。
人間活動による熱・電磁気的ノイズを表す時間依存係数。

*   昼間 (08:00 - 20:00): $0.8 \sim 1.0$ + ノイズ
*   夜間: $0.2$ + ノイズ

#### 4. Bio Factor (生体集合無意識要因)
`fetch_urban_bio.py` に実装（現在はSNS解析を模擬した確率モデル）。
集合的な不安や体感異常（「頭痛」など）のスパイクを検知。

*   通常時: $0.0 \sim 0.2$
*   異常検知時 (10%確率): $0.6 \sim 1.0$

## 4. リスク判定とアラート
算出された $Gup$ の絶対値 $|Gup|$ に基づき、リスクレベルを判定する。

| $|Gup|$ | リスクレベル (Risk Class) | ラベル |
| :--- | :--- | :--- |
| > 300 | EXTREME | **壊滅的** |
| > 150 | EXTREME | **極めて危険** |
| > 50 | HIGH | **危険** (Alert閾値) |
| > 20 | MODERATE | **注意** |

## 5. 考察と今後の課題
*   **理論との整合性**: Agdaで証明された「Winding Numberによる重力/影響力の創発」は、流体力学的なCurlとして直感的に実装されている。
*   **湿度の役割**: 湿度90%を閾値とする非線形増幅は、潜熱解放による急激な発達（ゲリラ豪雨など）を捉える上で有効と考えられる。
*   **Global Factorの検証**: 宇宙天気や地磁気が局所気象に与える係数（重み）の妥当性については、過去データを用いたパラメータチューニングが必要である。

以上
