
    <!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>UM-Infinity Time Machine Dashboard</title>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
        <style>
            body { font-family: 'Helvetica Neue', Arial, sans-serif; background: #1a1a1a; color: #e0e0e0; margin: 0; padding: 20px; }
            h1 { border-bottom: 2px solid #50e3c2; padding-bottom: 10px; color: #50e3c2; font-size: 24px; }
            .container { max-width: 1200px; margin: 0 auto; background: #252525; padding: 20px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
            
            #map { height: 600px; width: 100%; border-radius: 8px; margin-bottom: 20px; border: 1px solid #444; }
            
            .controls { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
            .time-btn { background: #333; color: #fff; border: 1px solid #555; padding: 10px 20px; cursor: pointer; border-radius: 4px; transition: 0.3s; }
            .time-btn:hover { background: #444; }
            .time-btn.active { background: #50e3c2; color: #000; font-weight: bold; border-color: #50e3c2; }
            
            .factors { display: flex; gap: 20px; margin-bottom: 30px; }
            .card { background: #333; padding: 15px; border-radius: 5px; flex: 1; text-align: center; }
            .card h3 { margin: 0 0 5px 0; font-size: 0.8em; color: #aaa; }
            .card .val { font-size: 1.4em; font-weight: bold; color: #fff; }
            .card .desc { font-size: 0.7em; color: #888; margin-top: 5px; }
            
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 0.9em; }
            th { text-align: left; border-bottom: 1px solid #555; padding: 10px; color: #888; }
            td { padding: 10px; border-bottom: 1px solid #333; }
            tr:hover { background: #2a2a2a; }
            
            .risk-LOW { color: #50e3c2; }
            .risk-MODERATE { color: #f5a623; }
            .risk-HIGH { color: #ff5e3a; font-weight: bold; }
            .risk-EXTREME { color: #ff0055; font-weight: bold; text-shadow: 0 0 5px #ff0055; }
            
            .desc-col { color: #ccc; }
            .region-col { font-weight: bold; color: #fff; font-size: 1.1em; }
            .coord-col { font-size: 0.8em; color: #777; }
            
            .footer { margin-top: 30px; font-size: 0.8em; color: #666; text-align: center; }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>UM∞N 気象監視システム "The Eye" (Phase 7: Time Machine)</h1>
            <p style="text-align:center; color:#888;">
                レポート生成時刻: 2026-01-10 18:05:54 (JST)
            </p>
            
            <div class="controls" id="timeControls">
                <!-- Dynamically populated buttons -->
            </div>
            <p style="text-align:center; font-weight:bold; color:#50e3c2; margin-bottom: 20px;">
                表示中のデータ: <span id="currentDataLabel">---</span>
            </p>
            
            <div id="map"></div>
            
            <div class="factors">
                <div class="card"><h3>宇宙天気 (Space)</h3><div class="val" id="valSpace">-</div></div>
                <div class="card"><h3>地磁気 (Geomag)</h3><div class="val" id="valGeomag">-</div></div>
                <div class="card"><h3>都市 (Urban)</h3><div class="val" id="valUrban">-</div></div>
                <div class="card"><h3>心理 (Bio)</h3><div class="val" id="valBio">-</div></div>
            </div>
            
            <h2>リスク検出地域 (Top 20)</h2>
            <table>
                <thead>
                    <tr>
                        <th>地域 / 座標</th>
                        <th>AI予測・現象解説</th>
                        <th>気温 / 湿度</th>
                        <th>GUP指数</th>
                        <th>危険度</th>
                    </tr>
                </thead>
                <tbody id="riskTableBody">
                    <!-- Dynamic Content -->
                </tbody>
            </table>
            
            <div class="footer">
                解析理論: UM∞N (Information-Theoretic Quantum Gravity)<br>
                Interactive Time Machine v1.0
            </div>
        </div>

        <script>
            // --- Data Ingestion ---
            var snapshots = [{"timestamp": "2026-01-10 17:50:00", "display_name": "01/10 17:50 (Monitor)", "space": 1.6088275798288532, "geomag": 0.734, "urban": 0.9071024273239313, "bio": 0.12526947203793423, "results": [{"lat": 24.055, "lon": 122.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.050737636944646, "humidity": 63.04970024004566, "region": "所野", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 123.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.884861075669612, "humidity": 63.32352095539976, "region": "与那国島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 123.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.634541535550355, "humidity": 63.53491625069256, "region": "波照間", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 123.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.868942572448198, "humidity": 63.97071388301768, "region": "波照間", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 123.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.421201562333817, "humidity": 63.05980473981755, "region": "波照間", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 124.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.287801070798963, "humidity": 61.57568112234885, "region": "石垣島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 124.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.220613761050895, "humidity": 61.28799206672295, "region": "盛山", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 124.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.214966592903004, "humidity": 60.646414991242345, "region": "盛山", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 124.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.199899481203314, "humidity": 59.98862647918993, "region": "仲筋", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 125.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.241377992948706, "humidity": 59.734157191579065, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 125.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.218413783569282, "humidity": 59.65140108315325, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 125.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.216232731328926, "humidity": 59.648105026825576, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 153.22833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.300000000000004, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 153.47833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.055, "lon": 153.72833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 122.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.209643427749263, "humidity": 62.57629927889179, "region": "所野", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 123.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.02470485868187, "humidity": 63.14416288382453, "region": "与那国島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 123.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.570371609493723, "humidity": 63.7427753919798, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 123.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.332024629428076, "humidity": 64.5406783017596, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 123.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.212249465577063, "humidity": 62.96772291065405, "region": "大原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 124.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.29505848898959, "humidity": 60.26882603001689, "region": "石垣島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 124.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.13355825378894, "humidity": 60.74292409500477, "region": "盛山", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 124.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.213621397171636, "humidity": 60.62983514929503, "region": "仲筋", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 124.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.21481662581927, "humidity": 59.94049140856544, "region": "仲筋", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 125.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.18538508651621, "humidity": 59.81267848047703, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 125.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.219307809979924, "humidity": 59.68308035037778, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 125.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.208909662879222, "humidity": 59.640336228833, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 153.22833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 153.47833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.305, "lon": 153.72833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 122.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.246061065970586, "humidity": 62.38779050374785, "region": "所野", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 123.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.074183631681922, "humidity": 63.09488037473921, "region": "与那国島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 123.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.582458108852773, "humidity": 63.68265669800951, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 123.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.384936468713033, "humidity": 64.73135615346749, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 123.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.252050310044677, "humidity": 62.5363869862637, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 124.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.02708629757121, "humidity": 60.92181070643492, "region": "伊原間", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 124.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.13997304611145, "humidity": 60.64863253853291, "region": "伊原間", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 124.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.267548800282437, "humidity": 60.1295943326297, "region": "仲筋", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 124.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.24572612711448, "humidity": 59.87562145150111, "region": "下地島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 125.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.20110020834057, "humidity": 59.69936358989678, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 125.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.191860339670978, "humidity": 59.64376805263349, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 125.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.19977230949183, "humidity": 59.630659069899174, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 125.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.209172165298416, "humidity": 59.638223098476736, "region": "鏡原", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 153.22833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 153.47833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.555, "lon": 153.72833333333335, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 22.3, "humidity": 79.0, "region": "南鳥島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.805, "lon": 122.97833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 18.190981943873357, "humidity": 62.7353824133621, "region": "所野", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.805, "lon": 123.22833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.9970462273226, "humidity": 63.29482634625204, "region": "与那国島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.805, "lon": 123.47833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.60331464655945, "humidity": 63.210131371043914, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}, {"lat": 24.805, "lon": 123.72833333333334, "winding_density": 0.0, "hydro_potential": 0.0, "temp": 17.408230864317037, "humidity": 63.08117266927892, "region": "西表島", "cloud_factor": 0.0, "grand_potential": 0.0}]}];
            var map = null;
            var layerGroup = null;

            function initMap() {
                map = L.map('map').setView([38.0, 137.0], 5);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                    attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
                    subdomains: 'abcd',
                    maxZoom: 19
                }).addTo(map);
                layerGroup = L.layerGroup().addTo(map);
            }

            function renderSnapshot(index) {
                var snap = snapshots[index];
                if(!snap) return;

                // 1. Update Labels
                document.getElementById('currentDataLabel').innerText = snap.timestamp + " (JST)";
                
                // 2. Update Controls Active State
                var btns = document.querySelectorAll('.time-btn');
                btns.forEach((b, i) => {
                    if(i === index) b.classList.add('active');
                    else b.classList.remove('active');
                });

                // 3. Update Factors
                document.getElementById('valSpace').innerText = snap.space.toFixed(2);
                document.getElementById('valGeomag').innerText = snap.geomag.toFixed(2);
                document.getElementById('valUrban').innerText = snap.urban.toFixed(2);
                document.getElementById('valBio').innerText = snap.bio.toFixed(2);

                // 4. Update Map
                layerGroup.clearLayers();
                snap.results.forEach(p => {
                    var radius = Math.min(Math.abs(p.grand_potential) * 500, 50000);
                    if (radius < 5000) radius = 5000;
                    
                    var circle = L.circle([p.lat, p.lon], {
                        color: p.risk_color,
                        fillColor: p.risk_color,
                        fillOpacity: 0.5,
                        radius: radius
                    }).addTo(layerGroup);
                    
                    circle.bindPopup("<b>" + p.region + "</b><br>Risk: " + p.grand_potential.toFixed(1) + "<br>" + p.desc);
                });

                // 5. Update Table
                var tbody = document.getElementById('riskTableBody');
                tbody.innerHTML = "";
                snap.results.slice(0, 20).forEach(res => {
                    var tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>
                            <span class="region-col">${res.region}付近</span><br>
                            <span class="coord-col">${res.lat.toFixed(3)}, ${res.lon.toFixed(3)}</span>
                        </td>
                        <td class="desc-col">${res.desc}</td>
                        <td>
                            ${res.temp.toFixed(1)}℃<br>
                            ${res.humidity.toFixed(0)}%
                        </td>
                        <td><strong>${res.grand_potential.toFixed(1)}</strong></td>
                        <td class="risk-${res.risk_cls}">${res.risk_label}</td>
                    `;
                    tbody.appendChild(tr);
                });
            }

            function initControls() {
                var container = document.getElementById('timeControls');
                snapshots.forEach((snap, idx) => {
                    var btn = document.createElement('button');
                    btn.className = 'time-btn';
                    btn.innerText = snap.display_name;
                    btn.onclick = function() { renderSnapshot(idx); };
                    container.appendChild(btn);
                });
            }

            // Start
            initMap();
            initControls();
            // Default to first (latest) snapshot
            if(snapshots.length > 0) renderSnapshot(0);
        </script>
    </body>
    </html>
    